<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>My Hakyll Blog - Functor, Applicative, and Monad</title>
  <meta name="description" content="This is a really greate blog">

  <link rel="canonical" href="http://ygpark2.github.io">
  <link rel="alternate" type="application/rss+xml" title="Young Gyu Blog" href="rss.xml" />

  <!-- Material Design Lite css Library -->
  <link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/code.getmdl.io/1.2.1/material.min.css">
  
  <!-- Material Design Fonts -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css">

  <!-- Custom theme css -->
  <link rel="stylesheet" href="../../../../assets/css/style.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>

  <!-- Material Design Lite js Library -->
  <script type="text/javascript" src="https://storage.googleapis.com/code.getmdl.io/1.2.1/material.min.js"></script>

  <!--
  
  <script rel="javascript" type="text/javascript" src="/assets/js/site.js"></script>
  

  <script rel="javascript" type="text/javascript" src="/assets/js/search.js"></script>
  <script rel="javascript" type="text/javascript">
    superSearch({
      searchFile: '/feed.xml',
      searchSelector: '#js-search', // CSS Selector for search container element.
      inputSelector: '#js-search__input', // CSS selector for <input>
      resultsSelector: '#js-search__results' // CSS selector for results container
    });
  </script>
  -->

  <script>hljs.initHighlightingOnLoad();</script>
</head>

  <body>

    <div class="mdl-layout mdl-js-layout">

      <!-- Start Layout -->
      
          <!-- search layout -->

<!--
<div class="super-search" id="js-search">
  <ul class="super-search__results" id="js-search__results"></ul>        
  <button class="mdl-button mdl-js-button mdl-button--fab mdl-button--colored super-search__close-btn" onclick="superSearch.toggle()">
    <i class="material-icons">close</i>
  </button>
</div>
-->

<!-- /end search -->

          
<header class="mdl-layout__header mdl-layout__header--waterfall">
  <!-- Top row, always visible -->
  <div class="first-head-row mdl-layout__header-row">
    <!-- Title -->
    <span class="mdl-layout-title">Young Gyu Blog</span>
    <div class="mdl-layout-spacer"></div>
    <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable mdl-textfield--floating-label mdl-textfield--align-right">

      <label class="mdl-button mdl-js-button mdl-button--icon" for="waterfall-exp">
        <i class="material-icons">search</i>
      </label>

      <div class="mdl-textfield__expandable-holder">
        <input class="mdl-textfield__input" type="text" name="sample" id="waterfall-exp">
      </div>

<!--
      <label class="mdl-button mdl-js-button mdl-button--icon" for="js-search__input" data-upgraded=",MaterialButton">
        <i class="material-icons">search</i>
      </label>

      <div class="mdl-textfield__expandable-holder">
        <input class="mdl-textfield__input super-search__input" type="text" id="js-search__input" />
      </div>

      <button class="mdl-button mdl-js-button mdl-button--icon" id="fixed-menu-lower-left">
        <i class="material-icons">more_vert</i>
      </button>

      <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="fixed-menu-lower-left">
        <li><a href="archive.html" class="mdl-menu__item">archive</a></li>
        <li><a href="about.html" class="mdl-menu__item">about</a></li>
        <li><a href="contact.html" class="mdl-menu__item">contact</a></li>
        <li><a href="tagCloud.html" class="mdl-menu__item">tagCloud</a></li>
      </ul>
-->

    </div>
  </div>
  <!-- Bottom row, not visible on scroll -->
  <div class="second-head-row mdl-layout__header-row">
    <div class="mdl-layout-spacer"></div>
    <!-- Navigation -->
    <nav class="waterfall-header-nav mdl-navigation">
      <a class="mdl-navigation__link" href="../../../../">Home</a>
      <a class="mdl-navigation__link" href="../../../../archive.html">Archive</a>
      <a class="mdl-navigation__link" href="../../../../tagCloud.html">Tags</a>
      <a class="mdl-navigation__link" href="../../../../about.html">About</a>
      <a class="mdl-navigation__link" href="../../../../contact.html">Contact</a>
    </nav>
  </div>
</header>

<div class="left-drawer mdl-layout__drawer">
  <span class="mdl-layout-title">메뉴</span>
  <nav class="mdl-navigation">
    <a class="mdl-navigation__link" href="../../../../">Home</a>
    <a class="mdl-navigation__link" href="../../../../archive.html">Archive</a>
    <a class="mdl-navigation__link" href="../../../../tagCloud.html">Tags</a>
    <a class="mdl-navigation__link" href="../../../../about.html">About</a>
    <a class="mdl-navigation__link" href="../../../../contact.html">Contact</a>
  </nav>
</div>

      

      <main class="mdl-layout__content">
        <div class="page-content mdl-grid">
          <!-- Your content goes here -->
          
<div class="mdl-grid" style="width: 100%;">
    <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">
        
        <div class="post-view-title mdl-card__media">
            <h3>Functor, Applicative, and Monad</h3>
        </div>
          
        <div class="post-view-header meta">
            <div class="minilogo" style="background-image: url('/images/avatar-64x64.png');"></div>
            <div class="info">
                <a href="../../../../about.html">
                    <strong>
                         Young Gyu 
                    </strong>
                </a>
                <span>2016-12-12</span>
            </div>
            
            <div class="section-spacer"></div>
            
        </div>
            
        <div class="post-view-content">
            <p>https://www.schoolofhaskell.com/school/advanced-haskell/functors-applicative-functors-and-monads</p>
<p>아주 간단한 문제로 시작해봅시다. 우리는 사용자로부터 생일을 입력받기를 원합니다. 그리고, 2020년에 사용자의 나이를 알려주는 프로그램을 작성할 것입니다. read 함수를 사용한 아주 간단한 프로그램입니다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>    year <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In 2020, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> (<span class="dv">2020</span> <span class="op">-</span> <span class="fu">read</span> year)</span></code></pre></div>
<!--more-->
<p>만약 그 프로그램을 실행 후 유효한 년도를 입력하면, 올바른 답을 구하실 것입니다. 만약 이상한 년도 값을 입력하면 어떤 일이 벌어질까요?</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="ex">Please</span> enter your birth year</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="ex">hello</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="ex">main.hs</span>: Prelude.read: no parse</span></code></pre></div>
<p>사용자 입력은 문자로 들어오고 그 문자를 Integer로 변환할려고 합니다. 그러나, 모든 문자들이 항상 유효한 Integer값은 아닙니다. read는 partial 함수입니다. 그것은 어떤 상황에서는 에러를 발생시킬수 있다는 것을 의미합니다.</p>
<p>좀더 견고한 프로그램을 작성하는 방법은 Maybe Integer 값을 반환하는 readMay함수를 쓰는것입니다. 이 함수는 그 파싱이 성공 또는 실패할지도 모르는 형들을 분명히 한다. 이것을 테스트할려면, 다음 코드를 실행해보세요. A more resilient way to write our code is to use the readMay function, which will return a Maybe Integer value. This makes it clear with the types themselves that the parse may succeed or fail. To test this out, try running the following code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="co">-- We use explicit types to tell the compiler how to try and parse the</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="co">-- string.</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="fu">print</span> (readMay <span class="st">&quot;1980&quot;</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">Integer</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">print</span> (readMay <span class="st">&quot;hello&quot;</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">Integer</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="fu">print</span> (readMay <span class="st">&quot;2000&quot;</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">Integer</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="fu">print</span> (readMay <span class="st">&quot;two-thousand&quot;</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">Integer</span>)</span></code></pre></div>
<p>그래서 어떻게 우리는 이 코드를 우리의 원래 문제를 풀기 위해서 사용할 수 있을까요? 우리는 readMay의 결과값 성공(Just) 또는 실패(Nothing)를 결정할 필요가 있습니다. 그 중 한 방법은 패턴 매칭을 사용하는 것입니다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    yearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="kw">case</span> readMay yearString <span class="kw">of</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided an invalid year&quot;</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="dt">Just</span> year <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In 2020, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> (<span class="dv">2020</span> <span class="op">-</span> year)</span></code></pre></div>
<p>디커필링 코드 이 코드는 약간 커플된 코드입니다. 이 코드를 사용자에게 출력을 출력하는 함수와 나이를 계산하는 또다른 함수로 나누어 보겠습니다.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided an invalid year&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In 2020, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>yearToAge year <span class="ot">=</span> <span class="dv">2020</span> <span class="op">-</span> year</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>    yearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>            <span class="kw">case</span> readMay yearString <span class="kw">of</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>                <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">Nothing</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>                <span class="dt">Just</span> year <span class="ot">-&gt;</span> <span class="dt">Just</span> (yearToAge year)</span>
<span id="cb5-17"><a href="#cb5-17"></a>    displayAge maybeAge</span></code></pre></div>
<p>This code does exactly the same thing as our previous version. But the definition of maybeAge in the main function looks pretty repetitive to me. We check if the parse year is Nothing. If it’s Nothing, we return Nothing. If it’s Just, we return Just, after applying the function yearToAge. That seems like a lot of line noise to do something simple. All we want is to conditionally apply yearToAge. 이 코드는 이전 버전과 정확히 같은것을 합니다. 그러나, 저에게 메인 함수에 있는 maybeAge 정의는 반복되고 있는것 같습니다. 우리는 파싱된 년도가 Nothing인지 확인합니다. 만약 Nothing이면, Nothing을 반환할것입니다. 만약 Just면, Just를 반환합니다.</p>
<p>펑터 당행히도, 우리는 그것을 하는 헬퍼 함수를 가지고 있습니다. fmap 또는 펑터 맵핑은 어떤 함수를 펑터가 가지고 있는 값에 적용할것입니다. Maybe는 펑터의 한 예입니다. 또다른 흔한 예는 리스트입니다. Maybe의 경우에도 fmap이 정확히 위에서 기술된대로 작동할것입니다. 그래서 다음과 같이 바꿀 수 있습니다.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided an invalid year&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In 2020, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>yearToAge year <span class="ot">=</span> <span class="dv">2020</span> <span class="op">-</span> year</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    yearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="fu">fmap</span> yearToAge (readMay yearString)</span>
<span id="cb6-14"><a href="#cb6-14"></a>    displayAge maybeAge</span></code></pre></div>
<p>Our code definitely got shorter, and hopefully a bit clearer as well. Now it’s obvious that all we’re doing is applying the yearToAge function over the contents of the Maybe value.</p>
<p>So what is a functor? It’s some kind of container of values. In Maybe, our container holds zero or one values. With lists, we have a container for zero or more values. Some containers are even more exotic; the IO functor is actually providing an action to perform in order to retrieve a value. The only thing functors share is that they provide some fmap function which lets you modify their contents.</p>
<p>do-notation We have another option as well: we can use do-notation. This is the same way we’ve been writing our main function in so far. That’s because- as we mentioned in the previous paragraph- IO is a functor as well. Let’s see how we can change our code to not use fmap:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided an invalid year&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In 2020, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a>yearToAge year <span class="ot">=</span> <span class="dv">2020</span> <span class="op">-</span> year</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>    yearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>            yearInteger <span class="ot">&lt;-</span> readMay yearString</span>
<span id="cb7-15"><a href="#cb7-15"></a>            <span class="fu">return</span> <span class="op">$</span> yearToAge yearInteger</span>
<span id="cb7-16"><a href="#cb7-16"></a>    displayAge maybeAge</span></code></pre></div>
<p>Inside the do-block, we have the slurp operator &lt;-. This operator is special for do-notation, and is used to pull a value out of its wrapper (in this case, Maybe). Once we’ve extracted the value, we can manipulate it with normal functions, like yearToAge. When we complete our do-block, we have to return a value wrapped up in that container again. That’s what the return function does.</p>
<p>do-notation isn’t available for all Functors; it’s a special feature reserved only for Monads. Monads are an extension of Functors that provide a little extra power. We’re not really taking advantage of any of that extra power here; we’ll need to make our program more complicated to demonstrate it.</p>
<p>Dealing with two variables It’s kind of limiting that we have a hard-coded year to compare against. Let’s fix that by allowing the user to specify the “future year.” We’ll start off with a simple implementation using pattern matching and then move back to do notation.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>            <span class="kw">case</span> readMay birthYearString <span class="kw">of</span></span>
<span id="cb8-15"><a href="#cb8-15"></a>                <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">Nothing</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>                <span class="dt">Just</span> birthYear <span class="ot">-&gt;</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>                    <span class="kw">case</span> readMay futureYearString <span class="kw">of</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>                        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="dt">Nothing</span></span>
<span id="cb8-19"><a href="#cb8-19"></a>                        <span class="dt">Just</span> futureYear <span class="ot">-&gt;</span> <span class="dt">Just</span> (futureYear <span class="op">-</span> birthYear)</span>
<span id="cb8-20"><a href="#cb8-20"></a>    displayAge maybeAge</span></code></pre></div>
<p>OK, it gets the job done… but it’s very tedious. Fortunately, do-notation makes this kind of code really simple:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb9-17"><a href="#cb9-17"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb9-18"><a href="#cb9-18"></a>            <span class="fu">return</span> <span class="op">$</span> yearDiff futureYear birthYear</span>
<span id="cb9-19"><a href="#cb9-19"></a>    displayAge maybeAge</span></code></pre></div>
<p>This is very convenient: we’ve now slurped our two values in our do-notation. If either parse returns Nothing, then the entire do-block will return Nothing. This demonstrates an important property about Maybe: it provides short circuiting.</p>
<p>Without resorting to other helper functions or pattern matching, there’s no way to write this code using just fmap. So we’ve found an example of code that requires more power than Functors provide, and Monads provide that power.</p>
<p>Partial application But maybe there’s something else that provides enough power to write our two-variable code without the full power of Monad. To see what this might be, let’s look more carefully at our types.</p>
<p>We’re working with two values: readMay birthYearString and readMay futureYearString. Both of these values have the type Maybe Integer. And we want to apply the function yearDiff, which has the type Integer -&gt; Integer -&gt; Integer.</p>
<p>If we go back to trying to use fmap, we’ll seemingly run into a bit of a problem. The type of fmap- specialized for Maybe and Integer- is (Integer -&gt; a) -&gt; Maybe Integer -&gt; Maybe a. In other words, it takes a function that takes a single argument (an Integer) and returns a value of some type a, takes a second argument of a Maybe Integer, and gives back a value of type Maybe a. But our function- yearDiff- actually takes two arguments, not one. So fmap can’t be used at all, right?</p>
<p>Not true actually. This is where one of Haskell’s very powerful features comes into play. Any time we have a function of two arguments, we can also look at is as a function of one argument which returns a function. We can make this more clear with parentheses:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1"></a><span class="ot">yearDiff ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="ot">yearDiff ::</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> (<span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="dt">So</span> how does that help us<span class="op">?</span> <span class="dt">We</span> can look at the <span class="fu">fmap</span> function as<span class="op">:</span></span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">fmap</span><span class="ot"> ::</span> (<span class="dt">Integer</span> <span class="ot">-&gt;</span> (<span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>))</span>
<span id="cb10-6"><a href="#cb10-6"></a>     <span class="ot">-&gt;</span> <span class="dt">Maybe</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (<span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="dt">Then</span> when we apply <span class="fu">fmap</span> to yearDiff, we end up with<span class="op">:</span></span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="fu">fmap</span><span class="ot"> yearDiff ::</span> <span class="dt">Maybe</span> <span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Maybe</span> (<span class="dt">Integer</span> <span class="ot">-&gt;</span> <span class="dt">Integer</span>)</span></code></pre></div>
<p>That’s pretty cool. We can apply this to our readMay futureYearString and end up with:</p>
<p>fmap yearDiff (readMay futureYearString) :: Maybe (Integer -&gt; Integer) That’s certainly very interesting, but it doesn’t help us. We need to somehow apply this value of type Maybe (Integer -&gt; Integer) to our readMay birthYearString of type Maybe Integer. We can do this with do-notation:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>            yearToAge <span class="ot">&lt;-</span> <span class="fu">fmap</span> yearDiff (readMay futureYearString)</span>
<span id="cb11-17"><a href="#cb11-17"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb11-18"><a href="#cb11-18"></a>            <span class="fu">return</span> <span class="op">$</span> yearToAge birthYear</span>
<span id="cb11-19"><a href="#cb11-19"></a>    displayAge maybeAge</span></code></pre></div>
<p>We can even use fmap twice and avoid the second slurp:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>            yearToAge <span class="ot">&lt;-</span> <span class="fu">fmap</span> yearDiff (readMay futureYearString)</span>
<span id="cb12-17"><a href="#cb12-17"></a>            <span class="fu">fmap</span> yearToAge (readMay birthYearString)</span>
<span id="cb12-18"><a href="#cb12-18"></a>    displayAge maybeAge</span></code></pre></div>
<p>But we don’t have a way to apply our Maybe (Integer -&gt; Integer) function to our Maybe Integer directly.</p>
<p>Applicative functors And now we get to our final concept: applicative functors. The idea is simple: we want to be able to apply a function which is inside a functor to a value inside a functor. The magic operator for this is &lt;*&gt;. Let’s see how it works in our example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;*&gt;))</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>            <span class="fu">fmap</span> yearDiff (readMay futureYearString)</span>
<span id="cb13-18"><a href="#cb13-18"></a>                <span class="op">&lt;*&gt;</span> readMay birthYearString</span>
<span id="cb13-19"><a href="#cb13-19"></a>    displayAge maybeAge</span></code></pre></div>
<p>In fact, the combination of fmap and &lt;*&gt; is so common that we have a special operator, &lt;$&gt;, which is a synonym for fmap. That means we can make our code just a little prettier:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;$&gt;), (&lt;*&gt;))</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb14-6"><a href="#cb14-6"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">-- show</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> yearDiff</span>
<span id="cb14-18"><a href="#cb14-18"></a>            <span class="op">&lt;$&gt;</span> readMay futureYearString</span>
<span id="cb14-19"><a href="#cb14-19"></a>            <span class="op">&lt;*&gt;</span> readMay birthYearString</span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">-- /show</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>    displayAge maybeAge</span></code></pre></div>
<p>Notice the distinction between &lt;$&gt; and &lt;*&gt;. The former uses a function which is not wrapped in a functor, while the latter applies a function which is wrapped up.</p>
<p>So we don’t need Monads? So if we can do such great stuff with functors and applicative functors, why do we need monads at all? The terse answer is context sensitivity: with a monad, you can make decisions on which processing path to follow based on previous results. With applicative functors, you have to always apply the same functions.</p>
<p>Let’s give a contrived example: if the future year is less than the birth year, we’ll assume that the user just got confused and entered the values in reverse, so we’ll automatically fix it by reversing the arguments to yearDiff. With do-notation and an if statement, it’s easy:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb15-7"><a href="#cb15-7"></a></span>
<span id="cb15-8"><a href="#cb15-8"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb15-16"><a href="#cb15-16"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb15-17"><a href="#cb15-17"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb15-18"><a href="#cb15-18"></a>            <span class="fu">return</span> <span class="op">$</span></span>
<span id="cb15-19"><a href="#cb15-19"></a>                <span class="kw">if</span> futureYear <span class="op">&lt;</span> birthYear</span>
<span id="cb15-20"><a href="#cb15-20"></a>                    <span class="kw">then</span> yearDiff birthYear futureYear</span>
<span id="cb15-21"><a href="#cb15-21"></a>                    <span class="kw">else</span> yearDiff futureYear birthYear</span>
<span id="cb15-22"><a href="#cb15-22"></a>    displayAge maybeAge</span></code></pre></div>
<p>Exercises Implement fmap using &lt;*&gt; and return.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;*&gt;), <span class="dt">Applicative</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">import</span> <span class="dt">Prelude</span> (return, <span class="dt">Monad</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Prelude</span></span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="fu">fmap</span><span class="ot"> ::</span> (<span class="dt">Applicative</span> m, <span class="dt">Monad</span> m) <span class="ot">=&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> (m a <span class="ot">-&gt;</span> m b)</span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">-- show</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="fu">fmap</span> <span class="op">...</span> <span class="op">...</span> <span class="ot">=</span> <span class="dt">FIXME</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">-- /show</span></span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a>main <span class="ot">=</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="kw">case</span> <span class="fu">fmap</span> (<span class="op">Prelude.+</span> <span class="dv">1</span>) (<span class="dt">Prelude.Just</span> <span class="dv">2</span>) <span class="kw">of</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>        <span class="dt">Prelude.Just</span> <span class="dv">3</span> <span class="ot">-&gt;</span> Prelude.putStrLn <span class="st">&quot;Good job!&quot;</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>        _ <span class="ot">-&gt;</span> Prelude.putStrLn <span class="st">&quot;Try again&quot;</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;*&gt;))</span>
<span id="cb16-15"><a href="#cb16-15"></a></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="co">-- show</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>myFmap function wrappedValue <span class="ot">=</span> <span class="fu">return</span> function <span class="op">&lt;*&gt;</span> wrappedValue</span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a>main <span class="ot">=</span> <span class="fu">print</span> <span class="op">$</span> myFmap (<span class="op">+</span> <span class="dv">1</span>) <span class="op">$</span> <span class="dt">Just</span> <span class="dv">5</span></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co">-- /show</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="dt">How</span> is <span class="fu">return</span> implemented for the <span class="dt">Maybe</span> monad<span class="op">?</span> <span class="dt">Try</span> replacing <span class="fu">return</span> with its implementation <span class="kw">in</span> the code above<span class="op">.</span></span>
<span id="cb16-22"><a href="#cb16-22"></a></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">-- show</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>returnMaybe <span class="ot">=</span> <span class="dt">FIXME</span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">-- /show</span></span>
<span id="cb16-26"><a href="#cb16-26"></a></span>
<span id="cb16-27"><a href="#cb16-27"></a>main</span>
<span id="cb16-28"><a href="#cb16-28"></a>    <span class="op">|</span> returnMaybe <span class="st">&quot;Hello&quot;</span> <span class="op">==</span> <span class="dt">Just</span> <span class="st">&quot;Hello&quot;</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Correct!&quot;</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Incorrect, please try again&quot;</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="fu">return</span> is simply the <span class="dt">Just</span> constructor<span class="op">.</span> <span class="dt">This</span> gets defined as<span class="op">:</span></span>
<span id="cb16-31"><a href="#cb16-31"></a></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="kw">instance</span> <span class="dt">Monad</span> <span class="dt">Maybe</span> <span class="kw">where</span></span>
<span id="cb16-33"><a href="#cb16-33"></a>    <span class="fu">return</span> <span class="ot">=</span> <span class="dt">Just</span></span></code></pre></div>
<p>yearDiff is really just subtraction. Try to replace the calls to yearDiff with explicit usage of the - operator.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb17-15"><a href="#cb17-15"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb17-16"><a href="#cb17-16"></a>            <span class="fu">return</span> <span class="op">$</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co">-- show</span></span>
<span id="cb17-18"><a href="#cb17-18"></a>                <span class="kw">if</span> futureYear <span class="op">&lt;</span> birthYear</span>
<span id="cb17-19"><a href="#cb17-19"></a>                    <span class="kw">then</span> yearDiff birthYear futureYear</span>
<span id="cb17-20"><a href="#cb17-20"></a>                    <span class="kw">else</span> yearDiff futureYear birthYear</span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="co">-- /show</span></span>
<span id="cb17-22"><a href="#cb17-22"></a>    displayAge maybeAge</span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb17-24"><a href="#cb17-24"></a></span>
<span id="cb17-25"><a href="#cb17-25"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb17-26"><a href="#cb17-26"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb17-27"><a href="#cb17-27"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb17-28"><a href="#cb17-28"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb17-29"><a href="#cb17-29"></a></span>
<span id="cb17-30"><a href="#cb17-30"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb17-31"><a href="#cb17-31"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb17-32"><a href="#cb17-32"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb17-33"><a href="#cb17-33"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb17-34"><a href="#cb17-34"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb17-35"><a href="#cb17-35"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb17-36"><a href="#cb17-36"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb17-37"><a href="#cb17-37"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb17-38"><a href="#cb17-38"></a>            <span class="fu">return</span> <span class="op">$</span></span>
<span id="cb17-39"><a href="#cb17-39"></a><span class="co">-- show</span></span>
<span id="cb17-40"><a href="#cb17-40"></a>                <span class="kw">if</span> futureYear <span class="op">&lt;</span> birthYear</span>
<span id="cb17-41"><a href="#cb17-41"></a>                    <span class="kw">then</span> birthYear <span class="op">-</span> futureYear</span>
<span id="cb17-42"><a href="#cb17-42"></a>                    <span class="kw">else</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb17-43"><a href="#cb17-43"></a><span class="co">-- /show</span></span>
<span id="cb17-44"><a href="#cb17-44"></a>    displayAge maybeAge</span></code></pre></div>
<p>It’s possible to write an applicative functor version of the auto-reverse-arguments code by modifying the yearDiff function. Try to do so.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;$&gt;), (&lt;*&gt;))</span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">-- show</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>yearDiff futureYear birthYear <span class="ot">=</span> <span class="dt">FIXME</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">-- /show</span></span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a>main</span>
<span id="cb18-14"><a href="#cb18-14"></a>    <span class="op">|</span> yearDiff <span class="dv">5</span> <span class="dv">6</span> <span class="op">==</span> <span class="dv">1</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Correct!&quot;</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Please try again&quot;</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb18-17"><a href="#cb18-17"></a></span>
<span id="cb18-18"><a href="#cb18-18"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb18-22"><a href="#cb18-22"></a></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">-- show</span></span>
<span id="cb18-24"><a href="#cb18-24"></a>yearDiff futureYear birthYear</span>
<span id="cb18-25"><a href="#cb18-25"></a>    <span class="op">|</span> futureYear <span class="op">&gt;</span> birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb18-26"><a href="#cb18-26"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> birthYear <span class="op">-</span> futureYear</span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co">-- /show</span></span>
<span id="cb18-28"><a href="#cb18-28"></a></span>
<span id="cb18-29"><a href="#cb18-29"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb18-30"><a href="#cb18-30"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb18-31"><a href="#cb18-31"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb18-32"><a href="#cb18-32"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb18-33"><a href="#cb18-33"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb18-34"><a href="#cb18-34"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb18-35"><a href="#cb18-35"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb18-36"><a href="#cb18-36"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb18-37"><a href="#cb18-37"></a>            <span class="fu">return</span> <span class="op">$</span></span>
<span id="cb18-38"><a href="#cb18-38"></a>                <span class="kw">if</span> futureYear <span class="op">&lt;</span> birthYear</span>
<span id="cb18-39"><a href="#cb18-39"></a>                    <span class="kw">then</span> yearDiff birthYear futureYear</span>
<span id="cb18-40"><a href="#cb18-40"></a>                    <span class="kw">else</span> yearDiff futureYear birthYear</span>
<span id="cb18-41"><a href="#cb18-41"></a>    displayAge maybeAge</span></code></pre></div>
<p>Now try to do it without modifying yearDiff directly, but by using a helper function which is applied to yearDiff.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">import</span> <span class="dt">Control.Applicative</span> ((&lt;$&gt;), (&lt;*&gt;))</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb19-8"><a href="#cb19-8"></a></span>
<span id="cb19-9"><a href="#cb19-9"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">-- show</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>yourHelperFunction f <span class="op">...</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">-- /show</span></span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a>main</span>
<span id="cb19-15"><a href="#cb19-15"></a>    <span class="op">|</span> yourHelperFunction yearDiff <span class="dv">5</span> <span class="dv">6</span> <span class="op">==</span> <span class="dv">1</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Correct!&quot;</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;Please try again&quot;</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="kw">import</span> <span class="dt">Safe</span> (readMay)</span>
<span id="cb19-18"><a href="#cb19-18"></a></span>
<span id="cb19-19"><a href="#cb19-19"></a>displayAge maybeAge <span class="ot">=</span></span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="kw">case</span> maybeAge <span class="kw">of</span></span>
<span id="cb19-21"><a href="#cb19-21"></a>        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="st">&quot;You provided invalid input&quot;</span></span>
<span id="cb19-22"><a href="#cb19-22"></a>        <span class="dt">Just</span> age <span class="ot">-&gt;</span> <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;In that year, you will be: &quot;</span> <span class="op">++</span> <span class="fu">show</span> age</span>
<span id="cb19-23"><a href="#cb19-23"></a></span>
<span id="cb19-24"><a href="#cb19-24"></a>yearDiff futureYear birthYear <span class="ot">=</span> futureYear <span class="op">-</span> birthYear</span>
<span id="cb19-25"><a href="#cb19-25"></a></span>
<span id="cb19-26"><a href="#cb19-26"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter your birth year&quot;</span></span>
<span id="cb19-28"><a href="#cb19-28"></a>    birthYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb19-29"><a href="#cb19-29"></a>    <span class="fu">putStrLn</span> <span class="st">&quot;Please enter some year in the future&quot;</span></span>
<span id="cb19-30"><a href="#cb19-30"></a>    futureYearString <span class="ot">&lt;-</span> <span class="fu">getLine</span></span>
<span id="cb19-31"><a href="#cb19-31"></a>    <span class="kw">let</span> maybeAge <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>            futureYear <span class="ot">&lt;-</span> readMay futureYearString</span>
<span id="cb19-33"><a href="#cb19-33"></a>            birthYear <span class="ot">&lt;-</span> readMay birthYearString</span>
<span id="cb19-34"><a href="#cb19-34"></a>            <span class="fu">return</span> <span class="op">$</span></span>
<span id="cb19-35"><a href="#cb19-35"></a>                <span class="kw">if</span> futureYear <span class="op">&lt;</span> birthYear</span>
<span id="cb19-36"><a href="#cb19-36"></a>                    <span class="kw">then</span> yourHelperFunction yearDiff birthYear futureYear</span>
<span id="cb19-37"><a href="#cb19-37"></a>                    <span class="kw">else</span> yourHelperFunction yearDiff futureYear birthYear</span>
<span id="cb19-38"><a href="#cb19-38"></a>    displayAge maybeAge</span>
<span id="cb19-39"><a href="#cb19-39"></a></span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">-- show</span></span>
<span id="cb19-41"><a href="#cb19-41"></a>yourHelperFunction f x y</span>
<span id="cb19-42"><a href="#cb19-42"></a>    <span class="op">|</span> x <span class="op">&gt;</span> y <span class="ot">=</span> f x y</span>
<span id="cb19-43"><a href="#cb19-43"></a>    <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> f y x</span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co">-- /show</span></span></code></pre></div>
        </div>
        
        <div class="post-view-footer"> 
             <p class="tags">Tags: <a href="../../../../tags/Haskell.html">Haskell</a>, <a href="../../../../tags/Functor.html">Functor</a>, <a href="../../../../tags/Applicative.html">Applicative</a>, <a href="../../../../tags/Monad.html">Monad</a></p> 
             <p class="categories">Category: <a href="../../../../categories/12.html">12</a></p> 
        </div>  
    </div>

    <nav class="hugo-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    
        <a href="../../../../post/shellprocesses/" class="hugo-nav__button">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation" data-upgraded=",MaterialButton,MaterialRipple">
            <i class="icon ion-android-arrow-back"></i>
            <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></button>
            Older
        </a>
        <div class="section-spacer"></div>
    
    </nav>

</div>
        </div>
        
        <footer class="page-footer mdl-mini-footer">
  <div class="mdl-mini-footer__left-section">
    <div class="mdl-logo">Title</div>
    <ul class="mdl-mini-footer__link-list">
      <li><a href="#">Help</a></li>
      <li><a href="#">Privacy & Terms</a></li>
    </ul>
  </div>
</footer>
      </main>
      <div class="mdl-layout__obfuscator"></div>
      <!-- /End Layout -->

    </div>
  </body>

</html>